{"version":3,"sources":["../../libs/parser.js"],"names":["canteenAlias","Parser","doc","url","base_url","meals","tables","getElementById","getElementsByTagName","i","length","table","id","dateString","textContent","startsWith","dateJSON","parseTimeMoment","rows","j","row","iskeinangebot","getElementsByClassName","infos","info","Object","assign","name","date","dateObject","category","slot","urlDetail","push","item","meal","rel2abs","getAttribute","includes","substring","indexOf","vectorImages","json","urlImages","a","imgs","img","vector","price","replace","base_meal","startIndex","canteenName","endIndex","trim","urlPicture","div","h2s","uls","lis","h2","list","notes","canteen","count","texts","moment","require","locale","format","parseTime","fecha","i18n","dayNamesShort","dayNames","monthNamesShort","monthNames","amPm","DoFn","D","daysInChinese","parse","getMonth","getDate","getDay","base","relative","stack","split","parts","pop","join"],"mappings":"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","file":"parser.js","sourcesContent":["import {Info, Meal} from \"./meal\";\n\nvar canteenAlias = {\n    \"Mensa WUeins / Sportsbar\": \"Mensa WUeins\",\n    \"BioMensa U-Boot (Bio-Code-Nummer: DE-ÖKO-021)\": \"BioMensa U-Boot\"\n}\n\nexport class Parser {\n    constructor(doc, url) {\n        this.doc = doc;\n        this.base_url = url;\n    }\n\n    parseMenu() {\n        // not sure if type needs to be checked or not\n        let doc = this.doc;\n        let base_url = this.base_url;\n        // console.log(doc)\n        var meals = []\n\n        var tables = doc.getElementById('spalterechtsnebenmenue').getElementsByTagName('table')\n        // console.log(tables)\n        for (var i = 0; i < tables.length; i++) {\n            var table = tables[i]\n            if (table.id !== 'aktionen') {\n                var dateString = table.getElementsByTagName('thead')[0].getElementsByTagName('tr')[0].getElementsByTagName('th')[0].textContent\n                if (!dateString.startsWith(\"Angebot\")) {\n                    continue\n                }\n                var dateJSON = parseTimeMoment(dateString)\n                var rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr')\n                for (var j = 0; j < rows.length; j++) {\n                    var row = rows[j]\n                    var iskeinangebot = row.getElementsByClassName('keinangebot').length !== 0\n                    if (iskeinangebot) {\n                        // no meals to be parsed (should)\n                        // console.debug(\"No meals today\")\n                    } else {\n                        var infos = row.getElementsByClassName('info')\n                        if (infos.length !== 0) {\n                            let info = new Info();\n                            Object.assign(info, {\n                                name: infos[0].textContent,\n                                date: dateJSON.dateString,\n                                dateObject: dateJSON.dateObject,\n                                category: 'Information',\n                                slot: 'Information',\n                                urlDetail: null\n                            });\n                            meals.push(info)\n                        } else {\n                            // parsing meal item starts\n                            var item = row.getElementsByClassName('text')[0]\n                            if (item) {\n                                let meal = new Meal();\n                                Object.assign(meal, {\n                                    name: item.textContent,\n                                    date: dateJSON.dateString,\n                                    dateObject: dateJSON.dateObject,\n                                });\n\n                                // parse urlDetail\n                                var urlDetail = row.getElementsByTagName('a')[0]\n                                if (urlDetail) {\n                                    var url = rel2abs(base_url, urlDetail.getAttribute('href'))\n                                    if (url.includes('?')) {\n                                        url = url.substring(0, url.indexOf('?'))\n                                    }\n                                    meal.urlDetail = url\n                                }\n\n                                // parse urlImages\n                                let vectorImages = [\"alkohol.png\", \"fleischlos.png\", \"knoblauch.png\", \"rindfleisch.png\", \"schweinefleisch.png\", \"vegan.png\"]\n                                let json = []\n                                let urlImages = row.getElementsByClassName('stoffe')[0]\n                                if (urlImages) {\n                                    let a = urlImages.getElementsByTagName('a')[0]\n                                    if (a) {\n                                        let imgs = a.getElementsByTagName('img')\n                                        for (let i = 0; i < imgs.length; i++) {\n                                            let img = imgs[i]\n                                            let url = rel2abs(base_url, img.getAttribute('src'))\n                                            for (let i = 0; i < vectorImages.length; i++) {\n                                                let vector = vectorImages[i]\n                                                if (url.includes(vector)) {\n                                                    url = vector\n                                                    break\n                                                }\n                                            }\n                                            json.push(url)\n                                        }\n                                    }\n                                }\n\n                                meal.urlImages = json\n                                // parse price information\n                                var price = row.getElementsByClassName('preise')[0]\n                                if (price) {\n                                    meal.price = price.textContent.replace('&euro;', '€').replace('&euro;', '€').replace('&nbsp;', '')\n                                }\n                                meals.push(meal)\n                            }\n                            // parsing meal item ends\n                        }\n                    }\n                }\n            }\n        }\n\n        return meals\n    }\n\n    parseMeal(base_meal) {\n        let doc = this.doc;\n        let base_url = this.base_url;\n        var meal = base_meal\n\n// parse slot information\n        var slot = doc.getElementById('speiseplandetails').getElementsByTagName('h1')[0].textContent\n        if (slot.includes('Abendangebot')) {\n            meal.slot = 'Abendangebot'\n        } else if (slot.includes('Sonntagsangebot')) {\n            meal.slot = 'Sonntagsangebot'\n        } else {\n            var startIndex = slot.indexOf('Angebot')\n            if (slot.includes(base_meal.canteenName)) {\n                startIndex = slot.indexOf(base_meal.canteenName) + base_meal.canteenName.length\n            }\n            var endIndex = slot.indexOf('vom')\n            if (startIndex !== -1 && endIndex !== -1) {\n                meal.slot = slot.substring(startIndex, endIndex).trim()\n            }\n        }\n\n// parse picture\n        var urlPicture = doc.getElementById('essenfoto')\n        if (urlPicture) {\n            urlPicture = urlPicture.getAttribute('href')\n            let url = rel2abs(base_url, urlPicture);\n            if (url.includes('?')) {\n                url = url.substring(0, url.indexOf('?'))\n            }\n            meal.urlPicture = url\n        }\n\n// parse notes information\n        let div = doc.getElementById('speiseplandetailsrechts')\n        if (div) {\n            let json = {}\n            let h2s = div.getElementsByTagName('h2')\n            let uls = div.getElementsByTagName('ul')\n            for (let i = 0; i < h2s.length; i++) {\n                if (uls[i]) {\n                    let lis = uls[i].getElementsByTagName('li')\n                    let h2 = h2s[i].textContent\n                    let list = []\n                    for (let j = 0; j < lis.length; j++) {\n                        list.push(lis[j].textContent)\n                    }\n                    json[h2] = list\n                }\n            }\n            meal.notes = json\n        } else {\n            meal.notes = {}\n        }\n\n// parsing ends\n        return meal\n    }\n\n    parseToday() {\n        var meals = {}\n\n        var tables = doc.getElementById('spalterechtsnebenmenue').getElementsByTagName('table')\n        // console.log(tables)\n        for (var i = 0; i < tables.length; i++) {\n            var table = tables[i]\n            if (table.id !== 'aktionen') {\n                var canteenName = table.getElementsByTagName('thead')[0].getElementsByTagName('tr')[0].getElementsByTagName('th')[0].textContent\n                if (!canteenName.startsWith(\"Angebot\")) {\n                    continue\n                }\n                var canteen = canteenName.substring(8).trim()\n                if (canteen in canteenAlias) {\n                    canteen = canteenAlias[canteen]\n                }\n                var rows = table.getElementsByTagName('tbody')\n                var count = 0\n                for (var j = 0; j < rows.length; j++) {\n                    var row = rows[j]\n                    var iskeinangebot = row.getElementsByClassName('keinangebot').length !== 0\n                    if (iskeinangebot) {\n                        // no meals to be parsed (should)\n                        break\n                    } else {\n                        var texts = row.getElementsByClassName('text')\n                        count += texts.length\n                    }\n                }\n                meals[canteen] = count\n            }\n        }\n        return meals\n    }\n}\n\nfunction parseTimeMoment(dateString) {\n    let moment = require(\"moment\")\n    moment.locale(\"de\");\n    let format = \"dddd, DD. MMMM YYYY\"\n    let date = moment(dateString, format)\n    date = date.locale(\"zh-cn\")\n    return {dateString: date.format('L'), dateObject: date}\n}\n\nfunction parseTime(dateString) {\n    var format = \"dddd, DD. MMMM YYYY\"\n    var fecha = require(\"fecha\")\n    fecha.i18n = {\n        dayNamesShort: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],\n        dayNames: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],\n        monthNamesShort: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],\n        monthNames: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],\n        amPm: ['am', 'pm'],\n        // D is the day of the month, function returns something like...  3rd or 11th\n        DoFn: function (D) {\n            return D + ['th', 'st', 'nd', 'rd'][D % 10 > 3 ? 0 : (D - D % 10 !== 10) * D % 10];\n        }\n    }\n    var daysInChinese = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']\n    var date = fecha.parse(dateString, format)\n    return {\n        dateString: (date.getMonth() + 1) + \"月\" + date.getDate() + \"日\" + \"（\" + daysInChinese[date.getDay()] + \"）\",\n        dateObject: date\n    }\n}\n\nfunction rel2abs(base, relative) {\n    if (relative.startsWith('//')) {\n        return \"https:\" + relative\n    }\n    var stack = base.split(\"/\"),\n        parts = relative.split(\"/\");\n    stack.pop(); // remove current file name (or empty string)\n    // (omit if \"base\" is the current folder without trailing slash)\n    for (var i = 0; i < parts.length; i++) {\n        if (parts[i] == \".\")\n            continue;\n        if (parts[i] == \"..\")\n            stack.pop();\n        else\n            stack.push(parts[i]);\n    }\n    return stack.join(\"/\");\n}"]}