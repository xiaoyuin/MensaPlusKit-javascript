{"version":3,"sources":["../../libs/canteen.js"],"names":["DomParser","require","request","canteens","getCanteenByName","name","i","length","canteen","fullName","getMenu","findCanteen","query","map","includes","date","callback","url","urlMeals","error","response","body","statusCode","parser","parseFromString","meals","parseMenu","m","canteenName","console","getDetail","module","exports","c"],"mappings":";;AAAA;;AAEA,IAAIA,YAAYC,QAAQ,YAAR,CAAhB;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;AACA,IAAIE,WAAWF,QAAQ,iBAAR,CAAf;;AAEA,SAASG,gBAAT,CAA0BC,IAA1B,EAAgC;AAC5B,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,SAASI,MAA7B,EAAqCD,GAArC,EAA0C;AACtC,YAAIE,UAAUL,SAASG,CAAT,CAAd;AACA,YAAIE,QAAQH,IAAR,KAAiBA,IAAjB,IAAyBG,QAAQC,QAAR,KAAqBJ,IAAlD,EAAwD;AACpDG,oBAAQE,OAAR,GAAkB,KAAKA,OAAvB;AACA,mBAAOF,OAAP;AACH;AACJ;AACD,WAAO,IAAP;AACH;;AAED,SAASG,WAAT,CAAqBC,KAArB,EAA4B;AACxB,WAAOT,SAASU,GAAT,CAAa,UAACL,OAAD;AAAA,eAAaA,QAAQH,IAAR,CAAaS,QAAb,CAAsBF,KAAtB,CAAb;AAAA,KAAb,CAAP;AACH;;AAED,SAASF,OAAT,CAAiBK,IAAjB,EAAuBC,QAAvB,EAAiC;;AAE7B,QAAIC,MAAM,KAAKC,QAAf;AACA,QAAIb,OAAO,KAAKA,IAAhB;;AAEAH,YAAQe,GAAR,EAAa,UAAUE,KAAV,EAAiBC,QAAjB,EAA2BC,IAA3B,EAAiC;AAC1C,YAAIF,KAAJ,EAAW;AACPH,qBAASG,KAAT;AACH,SAFD,MAEO;AACH,gBAAIC,SAASE,UAAT,KAAwB,GAA5B,EAAiC;AAC7B,oBAAIC,SAAS,mBAAW,IAAIvB,SAAJ,GAAgBwB,eAAhB,CAAgCH,IAAhC,CAAX,EAAkDJ,GAAlD,CAAb;AACA,oBAAIQ,QAAQF,OAAOG,SAAP,EAAZ;AACAV,yBAAS,IAAT,EAAeS,MAAMZ,GAAN,CAAU,UAACc,CAAD,EAAO;AAC5B,wBAAItB,IAAJ,EAAU;AACNsB,0BAAEC,WAAF,GAAgBvB,IAAhB;AACH;AACD,2BAAOsB,CAAP;AACH,iBALc,CAAf;AAMH,aATD,MASO;AACHE,wBAAQV,KAAR,CAAc,yCAAd;AACH;AACJ;AACJ,KAjBD;AAmBH;;AAED,SAASW,SAAT,CAAmBd,QAAnB,EAA6B;AACzB;;AAEH;;AAEDe,OAAOC,OAAP,GAAiB;AACb7B,cAAUA,SAASU,GAAT,CAAa,UAACoB,CAAD,EAAO;AAC1BA,UAAEvB,OAAF,GAAYA,OAAZ;AACA,eAAOuB,CAAP;AACH,KAHS,CADG;AAKb7B,sBAAkBA,gBALL;AAMbO,iBAAaA;AANA,CAAjB","file":"canteen.js","sourcesContent":["import {Parser} from \"./parser\";\n\nlet DomParser = require(\"dom-parser\");\nlet request = require(\"request\")\nlet canteens = require(\"./canteens.json\");\n\nfunction getCanteenByName(name) {\n    for (let i = 0; i < canteens.length; i++) {\n        let canteen = canteens[i];\n        if (canteen.name === name || canteen.fullName === name) {\n            canteen.getMenu = this.getMenu;\n            return canteen\n        }\n    }\n    return null\n}\n\nfunction findCanteen(query) {\n    return canteens.map((canteen) => canteen.name.includes(query))\n}\n\nfunction getMenu(date, callback) {\n\n    let url = this.urlMeals;\n    let name = this.name;\n\n    request(url, function (error, response, body) {\n        if (error) {\n            callback(error)\n        } else {\n            if (response.statusCode === 200) {\n                let parser = new Parser(new DomParser().parseFromString(body), url);\n                let meals = parser.parseMenu();\n                callback(null, meals.map((m) => {\n                    if (name) {\n                        m.canteenName = name;\n                    }\n                    return m;\n                }));\n            } else {\n                console.error(\"Can not connect to StudentenWerk server\");\n            }\n        }\n    })\n\n}\n\nfunction getDetail(callback) {\n    //TODO: Not implemented yet\n\n}\n\nmodule.exports = {\n    canteens: canteens.map((c) => {\n        c.getMenu = getMenu;\n        return c;\n    }),\n    getCanteenByName: getCanteenByName,\n    findCanteen: findCanteen,\n};\n\n"]}